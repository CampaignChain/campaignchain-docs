Call to Action Configuration
============================

To enable :ref:`CTA tracking <dev-book-overview-cta>` for a Channel, follow these steps:

1. Connect Channel
------------------

In the CampaignChain header menu, click the *Create New* button and select *Location*.

.. image:: /images/user/create_new_location.png
    :width: 600px

Then, choose the appropriate Location from the drop-down list, e.g. *Website* to
include a Website into CTA tracking.

.. image:: /images/administrator/select_new_website_location.png
    :width: 600px

Fill in the required data to connect the Channel. For example, provide the
base URL of a Website (you can omit adding pages of the Website).

.. image:: /images/administrator/connect_new_website_channel.png
    :width: 600px

Once you're done, CampaignChain will display a list of connected Channels to
you. This list will include the unique Channel Tracking ID that has been assigned
by CampaignChain to your new Channel. You will need this ID in the next step.

.. image:: /images/administrator/channels_list.png
    :width: 600px

2. Include Tracking Code
------------------------

2.1 Directly within HMTL Source Code
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If you own the Channel you plan to include and you also have full control
to directly manipulate the HTML source, then you can include a JavaScript file
provided by CampaignChain an all of your Channel's pages.

The file is named *campaignchain_tracking.js* and once you have it included, it
will take care of sending all the information for tracking CTAs to your
CampaignChain instance.

Include the file by adding the code mentioned below to your channel, ideally 
right before the closing body element (i.e. *</body>* element) and make sure that
it appears on all pages of the Channel.

2.2 Use Google Tag Manager
~~~~~~~~~~~~~~~~~~~~~~~~~~

In case you can't access the Channel or instead of waiting months for someon else
to update the code of a Channel, Google Tag Manager (GTM) comes to the rescue. It 
lets you launch new tags with just a few clicks. GTM supports container snippets,
a small piece of JavaScript or non-JavaScript code that it includes into your pages.

Google Tag Manager allows you to create a new *Custom HTML Tag* at the `GTM Web 
interface`_. Paste the CampaignChain tracking code into the *HMTL* section. Make 
sure the event is fired on all pages. The last step  is to publish your new tag in
GTM. 

2.3. The CampaignChain Tracking Code
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Independently from placing the tracking code diretly to the HTML source or using GTM,
here is how CampaignChain's default JavaScript tracking code looks like:

.. code-block:: html

    <script type="text/javascript" src="//[CAMPAIGNCHAIN INSTALLATION]/tracking.js"></script>
    <script type="text/javascript">
        cc('[CAMPAIGNCHAIN CHANNEL TRACKING ID]');
    </script>

Replace ``[CAMPAIGNCHAIN INSTALLATION]`` with the URL of the root of your CampaignChain
installation, e.g. *//campaignchain.example.com/tracking.js*.

.. note::
    Make sure you Omit ``http`` or ``https``, so that the script can work
    with either protocol.

Next, replace ``[CAMPAIGNCHAIN CHANNEL TRACKING ID]`` with the ID generated by
CampaignChain for your channel.

2.4 Anonymizing the Tracking Script
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If you want to hide from visitors to your CTA-tracked Channel, that you are
using CampaignChain or you want to custom brand the tracking code, then we have
configuration options for you in the *parameters.yml* file:

.. code-block:: yaml

    campaignchain.tracking.id_name: 'cctid'
    campaignchain.tracking.js_route: '/tracking.js'
    campaignchain.tracking.js_class: 'CCTracking'
    campaignchain.tracking.js_init: 'cc'

With *campaignchain.tracking.id_name*, you can define the name of the URL
parameter which CampaignChain attaches to links pointing to a connected channel.
Make sure the name you choose is short and as unique as possible, to avoid that
it collides with other parameters that might already be in the URL.

The URL of the tracking script itself can be changed with
*campaignchain.tracking.js_route*. There you defined the path aka URI to the
script relative to the base URL where CampaignChain is installed.

The name of the JavaScript class that appears inside the tracking script can
be customized with the *campaignchain.tracking.js_class* parameter.

Finally, *campaignchain.tracking.js_init* allows you to define the name of the
JavaScript function that is being called to pass the Channel ID in the tracking
code.

.. _GTM Web interface: https://tagmanager.google.com
